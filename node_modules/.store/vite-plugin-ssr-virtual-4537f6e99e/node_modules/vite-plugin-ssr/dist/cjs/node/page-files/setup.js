"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = require("path");
const getPageFiles_1 = require("../../shared/getPageFiles");
const utils_1 = require("../utils");
const globalContext_1 = require("../globalContext");
(0, getPageFiles_1.setPageFilesServerSideAsync)(getPageFilesExports);
async function getPageFilesExports() {
    const viteDevServer = (0, globalContext_1.getViteDevServer)();
    (0, utils_1.assert)(viteDevServer);
    // Current directory: vite-plugin-ssr/dist/cjs/node/page-files/
    const pluginRoot = (0, path_1.join)(__dirname, `../../../..`);
    const viteEntryPathDev = `${pluginRoot}/dist/esm/node/page-files/pageFiles-node.js`;
    const viteEntryResolved = (0, path_1.resolve)(viteEntryPathDev);
    const moduleExports = await viteDevServer.ssrLoadModule(viteEntryResolved);
    const pageFilesExports = moduleExports.default || moduleExports;
    (0, utils_1.assert)(pageFilesExports);
    return pageFilesExports;
}
